---
- hosts: leaf01
  vars_files:
    - vars.yml
  tasks:
    # - debug:
    #     #var: l3_interfaces.loopback.{{ansible_hostname}}
    #     msg: "{{item}}"
    #   with_items: "{{l3_interfaces.loopback}}"

    - name: Ping Test
      command: ping {{l3_interfaces.loopback[item].ipv4}} -I {{l3_interfaces.loopback[ansible_hostname].ipv4}} -c 1
      when: not {{item}} is "internet"
      with_items: "{{l3_interfaces.loopback}}"
